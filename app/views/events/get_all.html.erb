<div id="header">
  <h3>Event RSVP List</h3>
<% if @has_cache %>
<table>
  <thead>
    <tr>
      <th width="40"></th>
      <th width="40"></th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Guests</td>
    </tr>
  </thead>
  <tbody>
    <% @rsvps.each_with_index do |r| %>
      <tr>
        <td><% if r.attended %><i class="fa fa-check-square-o"></i> <% else%><i class="fa fa-square-o"></i><% end %></td>
        <td><%= form_tag({controller: 'events', action: 'find_person'}, method: 'get') do %>
          <%= hidden_field_tag 'first_name', r.first_name %>
          <%= hidden_field_tag 'last_name', r.last_name %>
          <%= hidden_field_tag 'email', r.email %>
          <%= hidden_field_tag 'phone', "" %>
          <%= hidden_field_tag 'mobile', "" %>
          <%= button_tag(type: 'submit', class:"no-style") do %>
            <i class="fa fa-edit"></i>
          <% end %>
        <% end %>
        </td>
        <td><%= r.first_name %></td>
        <td><%= r.last_name %></td>
        <td class="show-for-medium-up"><%= r.guests_count %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<% else %>

  <p style="clear:both;text-align:center">Slow load? Consider caching a copy of your RSVP list. <%= link_to 'Click here',  events_cache_path, class:'button' %></p>

  <div id="pagination" class="show-for-medium-up">
  <% if @current_page > 1 %>
    <%= link_to everyone_path(page: @current_page - 1), class:'button secondary' do %>
      <i class="fa fa-chevron-circle-left"></i> Previous
    <%end %>
  <% end %>
  <% if @current_page < @total_pages %>
    <%= link_to everyone_path(page: @current_page + 1), class:'button secondary' do %>
      Next <i class="fa fa-chevron-circle-right"></i>
    <% end %>
  <% end %>
  </div>
</div>

<table>
  <thead>
    <tr>
      <th width="40"></th>
      <th width="40"></th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Guests</td>
    </tr>
  </thead>
  <tbody>
    <% @persons.each_with_index do |p, i| %>
      <tr>
        <td><% if @rsvps[i]['attended'] %><i class="fa fa-check-square-o"></i> <% else%><i class="fa fa-square-o"></i><% end %></td>
        <td><%= form_tag({controller: 'events', action: 'find_person'}, method: 'get') do %>
          <%= hidden_field_tag 'first_name', p.first_name %>
          <%= hidden_field_tag 'last_name', p.last_name %>
          <%= hidden_field_tag 'email', p.email %>
          <%= hidden_field_tag 'phone', "" %>
          <%= hidden_field_tag 'mobile', "" %>
          <%= button_tag(type: 'submit', class:"no-style") do %>
            <i class="fa fa-edit"></i>
          <% end %>
        <% end %>
        </td>
        <td><%= p.first_name %></td>
        <td><%= p.last_name %></td>
        <td class="show-for-medium-up"><%= @rsvps[i]['guests_count'] %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="show-for-small-only" style="text-align:center;">
  <% if @current_page > 1 %>
    <%= link_to everyone_path(page: @current_page - 1), class:'button secondary' do %>
      <i class="fa fa-chevron-circle-left"></i> Previous
    <%end %>
  <% end %>
  <% if @current_page < @total_pages %>
    <%= link_to everyone_path(page: @current_page + 1), class:'button secondary' do %>
      Next <i class="fa fa-chevron-circle-right"></i>
    <% end %>
  <% end %>
</div>

<% end %>